{"version":3,"file":"data-table-container.js","sources":["../../../src/components/ember-interactive-table/data-table-container.js"],"sourcesContent":["import { tracked } from '@glimmer/tracking';\nimport { action } from '@ember/object';\nimport Component from '@glimmer/component';\nimport isEmptyObject from '../../utils/is-empty-object';\n\nexport default class DataTableContainer extends Component {\n  @tracked trashed;\n  @tracked pageTitle;\n  @tracked model;\n\n  get title() {\n    return this.args.trashed\n      ? `${this.args.pageTitle} | TRASH`\n      : this.args.pageTitle;\n  }\n\n  get itemsSelected() {\n    return this.args.model.filter((item) => item.selected === true).length > 0;\n  }\n\n  get deleteRestoreButtonMode() {\n    return this.args.trashed ? 'restore' : 'delete';\n  }\n\n  get deleteRestoreButtonIcon() {\n    return this.args.trashed\n      ? 'svg-repo/icons/icon-processing'\n      : 'svg-repo/icons/icon-trash';\n  }\n\n  get toggleTrashViewButtonText() {\n    return this.args.trashed ? 'Exit Trash' : 'View Trash';\n  }\n\n  get toggleTrashViewButtonIcon() {\n    return this.args.trashed\n      ? 'svg-repo/icons/icon-cross'\n      : 'svg-repo/icons/icon-trash';\n  }\n\n  get modelMetaData() {\n    return this.args.model.meta;\n  }\n\n  get paginationLinks() {\n    if (isEmptyObject(this.args.model.links || {})) {\n      return;\n    }\n    return this.args.model.links;\n  }\n\n  get filteredDataLength() {\n    return this.modelMetaData.filtered_data_length;\n  }\n\n  get filtersActive() {\n    return this.filteredDataLength < this.modelMetaData.total_data_length;\n  }\n\n  get showFiltersForm() {\n    if (\n      this.modelMetaData.total_data_length > 0 &&\n      (this.filtersActive === true || this.filtersActive === false)\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  get singleRecordName() {\n    return this.args.singleRecordName || 'item';\n  }\n\n  get pluralRecordName() {\n    return this.args.pluralRecordName || `${this.singleRecordName}s`;\n  }\n\n  @action\n  selectAll(prop, value) {\n    this.args.model.forEach((item) => {\n      item[prop] = value;\n    });\n  }\n\n  @action\n  deleteOrRestoreSelected(mode) {\n    var selectedItems = this.args.model.filter(\n      (item) => item.selected === true,\n    );\n    var counter = {\n      success: 0,\n      fail: 0,\n    };\n    selectedItems.forEach(function (item) {\n      var deleted = mode === 'delete' ? true : false;\n      item.deleted = deleted;\n      item\n        .toggleDeleted()\n        .then(() => {\n          counter.success++;\n          if (counter.success + counter.fail === selectedItems.length) {\n            this.deleteOrRestoreResponseMessage(\n              mode,\n              counter,\n              selectedItems.length,\n            );\n            this.args.refreshModel();\n          }\n        })\n        .catch(() => {\n          counter.fail++;\n          if (counter.success + counter.fail === selectedItems.length) {\n            this.deleteOrRestoreResponseMessage(\n              mode,\n              counter,\n              selectedItems.length,\n            );\n            this.args.refreshModel();\n          }\n        });\n    });\n  }\n\n  @action\n  deleteOrRestoreResponseMessage(mode, counter, selectedItemsLength) {\n    var flashType;\n    var flashMessage;\n    if (counter.success === selectedItemsLength) {\n      flashType = 'success';\n      flashMessage = `${counter.success} items ${mode}d.`;\n    } else if (counter.fail === selectedItemsLength) {\n      flashType = 'danger';\n      flashMessage = `Deletion failed. Please try again.`;\n    } else {\n      flashType = 'warning';\n      flashMessage = `${counter.success} items were ${mode}d, but ${counter.fail} deletions failed.`;\n    }\n    this.args.flashMessages.add({\n      type: flashType,\n      message: flashMessage,\n    });\n  }\n\n  @action\n  onCheckboxClick(value, event, item) {\n    if (event.shiftKey) {\n      if (this.lastSelectedItem) {\n        const items = this.args.model.items;\n        const selectedIndex = items.indexOf(item);\n        const lastSelectedIndex = items.indexOf(this.args.lastSelectedItem);\n        let itemsToSelect = [];\n        if (lastSelectedIndex > selectedIndex) {\n          itemsToSelect = items.slice(selectedIndex, lastSelectedIndex);\n        } else {\n          itemsToSelect = items.slice(lastSelectedIndex, selectedIndex);\n        }\n        itemsToSelect.forEach((item) => {\n          item.selected = true;\n        });\n      }\n    }\n    this.lastSelectedItem = item;\n  }\n}\n"],"names":["DataTableContainer","Component","g","prototype","tracked","i","void 0","title","args","trashed","pageTitle","itemsSelected","model","filter","item","selected","length","deleteRestoreButtonMode","deleteRestoreButtonIcon","toggleTrashViewButtonText","toggleTrashViewButtonIcon","modelMetaData","meta","paginationLinks","isEmptyObject","links","filteredDataLength","filtered_data_length","filtersActive","total_data_length","showFiltersForm","singleRecordName","pluralRecordName","selectAll","prop","value","forEach","n","action","deleteOrRestoreSelected","mode","selectedItems","counter","success","fail","deleted","toggleDeleted","then","deleteOrRestoreResponseMessage","refreshModel","catch","selectedItemsLength","flashType","flashMessage","flashMessages","add","type","message","onCheckboxClick","event","shiftKey","lastSelectedItem","items","selectedIndex","indexOf","lastSelectedIndex","itemsToSelect","slice","setComponentTemplate","TEMPLATE"],"mappings":"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"}