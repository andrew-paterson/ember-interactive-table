{"version":3,"file":"build-request-params.js","sources":["../../src/utils/build-request-params.js"],"sourcesContent":["import _merge from 'lodash.merge';\nimport { unflatten } from 'flat';\n\nexport default function buildRequestParams(queryParams, queryParamsObjects) {\n  var qpObjects = [];\n  queryParamsObjects.forEach((qpObject) => {\n    delete qpObject.value;\n    qpObject = setQpObjectValue(queryParams, qpObject);\n    if (qpObject.customTransforms) {\n      qpObject.customTransforms(qpObject, queryParams);\n    }\n    if (qpObject.value) {\n      var path = qpObject.parent\n        ? `${qpObject.parent}.${qpObject.key}`\n        : qpObject.key;\n      const obj = {};\n      obj[path] = qpObject.value;\n      qpObjects.push(unflatten(obj));\n    }\n  });\n\n  var final = {};\n  var acc = final;\n  qpObjects.forEach((item) => {\n    acc = _merge(acc, item);\n  });\n  return final;\n}\n\nfunction setQpObjectValue(queryParams, qpObject) {\n  var propKey = qpObject.qpKey || qpObject.key;\n  if (queryParams[propKey]) {\n    qpObject.value = queryParams[propKey];\n  } else {\n    return qpObject;\n  }\n  if (qpObject.type === 'array') {\n    if (typeof qpObject.value === 'string') {\n      qpObject.value = qpObject.value.split(',');\n    }\n    if (qpObject.filtersForm) {\n      qpObject.filtersForm.options = qpObject.filtersForm.options || [];\n      if (qpObject.value.length === qpObject.filtersForm.options.length) {\n        qpObject.value = null;\n      }\n    }\n  }\n  return qpObject;\n}\n"],"names":["buildRequestParams","queryParams","queryParamsObjects","qpObjects","forEach","qpObject","value","setQpObjectValue","customTransforms","path","parent","key","obj","push","unflatten","final","acc","item","_merge","propKey","qpKey","type","split","filtersForm","options","length"],"mappings":";;;AAGe,SAASA,kBAAkBA,CAACC,WAAW,EAAEC,kBAAkB,EAAE;EAC1E,IAAIC,SAAS,GAAG,EAAE;AAClBD,EAAAA,kBAAkB,CAACE,OAAO,CAAEC,QAAQ,IAAK;IACvC,OAAOA,QAAQ,CAACC,KAAK;AACrBD,IAAAA,QAAQ,GAAGE,gBAAgB,CAACN,WAAW,EAAEI,QAAQ,CAAC;IAClD,IAAIA,QAAQ,CAACG,gBAAgB,EAAE;AAC7BH,MAAAA,QAAQ,CAACG,gBAAgB,CAACH,QAAQ,EAAEJ,WAAW,CAAC;AAClD;IACA,IAAII,QAAQ,CAACC,KAAK,EAAE;AAClB,MAAA,IAAIG,IAAI,GAAGJ,QAAQ,CAACK,MAAM,GACrB,GAAEL,QAAQ,CAACK,MAAO,CAAA,CAAA,EAAGL,QAAQ,CAACM,GAAI,EAAC,GACpCN,QAAQ,CAACM,GAAG;MAChB,MAAMC,GAAG,GAAG,EAAE;AACdA,MAAAA,GAAG,CAACH,IAAI,CAAC,GAAGJ,QAAQ,CAACC,KAAK;AAC1BH,MAAAA,SAAS,CAACU,IAAI,CAACC,SAAS,CAACF,GAAG,CAAC,CAAC;AAChC;AACF,GAAC,CAAC;EAEF,IAAIG,KAAK,GAAG,EAAE;EACd,IAAIC,GAAG,GAAGD,KAAK;AACfZ,EAAAA,SAAS,CAACC,OAAO,CAAEa,IAAI,IAAK;AAC1BD,IAAAA,GAAG,GAAGE,MAAM,CAACF,GAAG,EAAEC,IAAI,CAAC;AACzB,GAAC,CAAC;AACF,EAAA,OAAOF,KAAK;AACd;AAEA,SAASR,gBAAgBA,CAACN,WAAW,EAAEI,QAAQ,EAAE;EAC/C,IAAIc,OAAO,GAAGd,QAAQ,CAACe,KAAK,IAAIf,QAAQ,CAACM,GAAG;AAC5C,EAAA,IAAIV,WAAW,CAACkB,OAAO,CAAC,EAAE;AACxBd,IAAAA,QAAQ,CAACC,KAAK,GAAGL,WAAW,CAACkB,OAAO,CAAC;AACvC,GAAC,MAAM;AACL,IAAA,OAAOd,QAAQ;AACjB;AACA,EAAA,IAAIA,QAAQ,CAACgB,IAAI,KAAK,OAAO,EAAE;AAC7B,IAAA,IAAI,OAAOhB,QAAQ,CAACC,KAAK,KAAK,QAAQ,EAAE;MACtCD,QAAQ,CAACC,KAAK,GAAGD,QAAQ,CAACC,KAAK,CAACgB,KAAK,CAAC,GAAG,CAAC;AAC5C;IACA,IAAIjB,QAAQ,CAACkB,WAAW,EAAE;MACxBlB,QAAQ,CAACkB,WAAW,CAACC,OAAO,GAAGnB,QAAQ,CAACkB,WAAW,CAACC,OAAO,IAAI,EAAE;AACjE,MAAA,IAAInB,QAAQ,CAACC,KAAK,CAACmB,MAAM,KAAKpB,QAAQ,CAACkB,WAAW,CAACC,OAAO,CAACC,MAAM,EAAE;QACjEpB,QAAQ,CAACC,KAAK,GAAG,IAAI;AACvB;AACF;AACF;AACA,EAAA,OAAOD,QAAQ;AACjB;;;;"}